# -------------------- Display settings --------------------

display_name: '&e[主線]雪山之戰'

start_notify:
  title: '&a任務開始'
  title_subtitle: '&7開始進行 &a{quest} &7任務'
  sound: ENTITY_PLAYER_LEVELUP

progress_notify:
  actionbar: '&a{quest} &7| {objective}'

all_status_item:
  type: END_CRYSTAL
  name: '&6{quest}'
  lore: |-
    &f--------------------
    &f任務報酬：
    &f- &e金幣&fx1000
    &f- &a總經驗值&fx78400
    &f--------------------{detailed_progression}
    {controls}

# -------------------- Post-quest settings --------------------

completion:
  notify:
    SUCCESS:
      title: '&d任務完成'
      title_subtitle: '&7你完成了任務 &a{quest} &7!'
      sound: ENTITY_PLAYER_LEVELUP
      message:
        - '&f--------------------'
        - '&f解鎖&e[主線]龍之後裔'
        - '&f可在&a[內湖營地]&f向&a<炎鎮>&f接取'
        - '&f--------------------'
        - '&f需要滿足以下條件才能接取任務：'
        - '&a等級：Lv24'
        - '&f--------------------'
    FAIL:
      title: '&cQuest failed'
      title_subtitle: '&7You failed quest &c{quest} &7!'
      sound: BLOCK_ANVIL_DESTROY
    CANCEL:
      title: '&c任務取消'
      title_subtitle: '&7你取消了任務 &c{quest}'
      sound: BLOCK_ANVIL_DESTROY

activators: [cnpc60]

conditions_start_restriction:
  match_amount: 2
  conditions:
    1:
      type: LOGIC
      logic: '%mmocore_level% >= 23'
    2:
      type: QUEST_COMPLETED
      model: a_quest_22

display_priority: 1

branches:

  main:
    starts_at: 1
    objects:

      1:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 2
        toggle: true

      2:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 3
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<炎鎮> &f來吧!少年!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<炎鎮> &f我們出發去討伐不死族吧!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      3:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 4
        toggle: false
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b前往&a[雪山深處]'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f前往&a[雪山深處]'

      4:
        type: PLAYER_POSITION
        objective_detail: '&f前往&a[雪山深處]'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
        goto: OBJECT 5
        position:
          type: SPHERE_INSIDE
          radius: 10
          center: world,-1410,107,107

      5:
        type: SERVER_COMMANDS_PERFORM
        objective_detail: '&f進入&a[雪山深處]'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
        goto: OBJECT 6
        commands: ['tppos {player} -1385 86 107 270 0 world_story']
        
      6:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 7
        actions:
          - 'SEND_MESSAGE &e[1/5]&a<炎鎮> &f少年!你自已小心了!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/5]&a<炎鎮> &f盡可能擊殺他們吧!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/5]&a<炎鎮> &f記得不要受傷就好了!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/5]&a<炎鎮> &f皇家禁衛軍!上吧！第一小隊先上前!第二....'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[5/5]&f(看來是一場硬戰了...我也要努力起來！)'
          - WAIT_TICKS 40

      7:
        type: PLAYER_MYTHICMOBS_MOBS_KILL
        objective_detail: '&f擊殺&a【Lv25】骷髏地精 &b{objective_progression:0}&f/&b{objective_goal:0}'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b{objective_progression:0}&f/&b{objective_goal:0}'
        goto: OBJECT 8
        goals:
          0:
            mobs: 'test6'
            goal: 20
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b擊殺&a【Lv25】骷髏地精'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f擊殺&a【Lv25】骷髏地精'
            
      8:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 9
        toggle: true
        
      9:
        type: SERVER_COMMANDS_PERFORM
        objective_detail: '&f你突然動不了'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 10
        commands:
        - ml statmod {player} MAX_HEALTH 4000 200
        - heal {player}
        
      10:
        type: SERVER_ACTIONS
        objective_detail: '&f你突然動不了'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 11
        actions:
          - 'SEND_MESSAGE &b[故事劇情](怎麼...怎麼回事...好像...)'
          - WAIT_TICKS 40

      11:
        type: SERVER_COMMANDS_PERFORM
        objective_detail: '&f你突然動不了'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 12
        commands:
        - effect give {player} minecraft:blindness 23
        - effect give {player} minecraft:nausea 23
        
      12:
        type: SERVER_ACTIONS
        objective_detail: '&f你突然動不了'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 13
        actions:
          - 'SEND_MESSAGE &b[故事劇情](視野有點...蒙糊...)'
          - WAIT_TICKS 40
          
      13:
        type: SERVER_COMMANDS_PERFORM
        objective_detail: '&f你突然動不了'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 14
        commands: ['tppos {player} -1378 17 109 0 0 world_story']
        
      14:
        type: SERVER_ACTIONS
        objective_detail: '&f你的意識很蒙糊...'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 15
        actions:
          - 'SEND_MESSAGE &b[故事劇情](你心想:我到底在哪...)'
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[1/3]&a<神秘聲音> &f你一定要保護好「她」...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &b[故事劇情](你心想:她...？她是誰...)'
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<神秘聲音> &f答應我...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<神秘聲音> &f不能讓「黑暗軍團」的人抓到「她」...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &b[故事劇情](你心想:不是...她是誰...黑暗甚麼...?)'
          - WAIT_TICKS 40
          
      15:
        type: SERVER_COMMANDS_PERFORM
        objective_detail: '&f你的意識很蒙糊...'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
        goto: OBJECT 16
        commands: ['tppos {player} -924 87 -65 90 0 world']
        
      16:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 17
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<炎鎮> &f少年！你沒事吧！'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      17:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<炎鎮>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [炎鎮大哥？...我在哪...]'
            goto: OBJECT 18
            
      18:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 19
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<炎鎮> &f剛剛在戰鬥的時候，你突然暈倒了！'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      19:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<炎鎮>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [是嗎...剛剛我聽到一些奇怪的聲音]'
            goto: OBJECT 20
            
      20:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 21
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<炎鎮> &f甚麼聲音？'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      21:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<炎鎮>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [有人跟我說要保護她...]'
            goto: OBJECT 22
            
      22:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 23
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<炎鎮> &f可能是我們軍隊的人送你回來時候說話吧！'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      23:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<炎鎮>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [也有可能...我們贏了嗎？]'
            goto: OBJECT 24
            
      24:
        type: SERVER_ACTIONS
        objective_detail: '&a<炎鎮>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-2 &f前往&a[雪山深處]'
          - '&f步驟-3 &f與&a<炎鎮#65>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv25】骷髏地精 &b20&f/&b20'
          - '&f步驟-5 &f與&a<炎鎮#65>&f對話'
        goto: OBJECT 25
        actions:
          - 'SEND_MESSAGE &e[1/3]&a<炎鎮> &f當然!不殺光它們我是不會走的'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<炎鎮> &f它們應該在短時間都不會有行動的了!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<炎鎮> &f你先休息一下吧!辛苦你了!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      25:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: QUEST_SUCCESS
        toggle: false


end_objects:
  success:
    a:
      type: SERVER_COMMANDS_PERFORM
      commands:
        - eco give {player} 1000
        - mmocore admin exp give {player} farm 78400
        - mmocore admin exp give {player} fishing 78400
        - mmocore admin exp give {player} food 78400
        - mmocore admin exp give {player} handicraft 78400
        - mmocore admin exp give {player} main 78400
        - mmocore admin exp give {player} mining 78400
        - mmocore admin exp give {player} alchemy 78400
  cancel:
    1:
      type: SERVER_COMMANDS_PERFORM
      commands: ['compass stop {player}']