# -------------------- Display settings --------------------

display_name: '&e[主線]受歡迎的餐廳&a(回顧)'

start_notify:
  title: '&a任務開始'
  title_subtitle: '&7開始進行 &a{quest} &7任務'
  sound: ENTITY_PLAYER_LEVELUP

progress_notify:
  actionbar: '&a{quest} &7| {objective}'

all_status_item:
  type: END_CRYSTAL
  name: '&6{quest}'
  lore: |-
    &f--------------------
    &f不會有任務獎勵
    &f--------------------{detailed_progression}
    {controls}

# -------------------- Post-quest settings --------------------

completion:
  notify:
    SUCCESS:
      title: '&d任務完成'
      title_subtitle: '&7你完成了任務 &a{quest} &7!'
      sound: ENTITY_PLAYER_LEVELUP
    FAIL:
      title: '&cQuest failed'
      title_subtitle: '&7You failed quest &c{quest} &7!'
      sound: BLOCK_ANVIL_DESTROY
    CANCEL:
      title: '&c任務取消'
      title_subtitle: '&7你取消了任務 &c{quest}'
      sound: BLOCK_ANVIL_DESTROY

activators: [cnpc103]

conditions_start_restriction:
  match_amount: 1
  conditions:
    1:
      type: QUEST_COMPLETED
      model: a_quest_06

completion:
  max_completions: 99999999

display_priority: 1

branches:

  main:
    starts_at: 0
    objects:

      0:
        type: PLAYER_CITIZENS_NPC_INTERACT
        objective_detail: '&f與&a<羅德>&f對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
        goto: OBJECT 1
        position:
          type: CITIZENS_NPC_RELATIVE_SINGLE
          npc: 437
        npc: 437
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b與&a<羅德@42>&f對話'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f與&a<羅德@42>&f對話'

      1:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 2
        toggle: true

      2:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<羅德@42>&f對話'
        goto: OBJECT 3
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<羅德> &f喔喔,是一個新的冒險者'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<羅德> &f你好,我是這裡的接待員,大家都叫我&a羅德'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      3:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<羅德>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[羅德你好,我是&6{player}&f]'
            goto: OBJECT 4
            
      4:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<羅德@42>&f對話'
        goto: OBJECT 5
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<羅德> &f你來得真是時候,&a[東日漁村]&f正面臨很多方面的危機QwQ'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<羅德> &f剛好來了很多委托,但是沒有冒險者在這附近'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      5:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<羅德>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[哈哈,那真巧,我也是誤打誤撞來到這裏的,哈哈]'
            goto: OBJECT 6
            
      6:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<羅德@42>&f對話'
        goto: OBJECT 7
        actions:
          - 'SEND_MESSAGE &e[1/5]&a<羅德> &f那就麻煩你了,我先給你一個委托'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/5]&a<羅德> &f幫這裡的餐廳收集大量的小麥...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/5]&a<羅德> &f我指的大量是真的很大量'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/5]&a<羅德> &f這已經是這星期第5次的委托了...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[5/5]&a<羅德> &f有些冒險者都做到怕了!!!'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      7:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<羅德>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[那餐廳真的很好吃嗎?]'
            goto: OBJECT 8

      8:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<羅德@42>&f對話'
        goto: OBJECT 9
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f這個就不好說了,你收集足夠的&a[小麥]&f交付任務就懂了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &b[故事劇情](雖然你不太懂,但還是收集&a[小麥]&f吧)'
          - WAIT_TICKS 20

      9:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 10
        toggle: false
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b交付&a[小麥]&f給&a<艾琳娜@31>'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f交付&a[小麥]&f給&a<艾琳娜@31>'
          
      10:
        type: PLAYER_CITIZENS_NPC_DELIVER_ITEMS
        gps:
          enabled: false
        npc: 52
        objective_detail: '&f交付&a[小麥]&f給&a<艾琳娜@31> &b{objective_progression:0}&f/&b{objective_goal:0}'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b{objective_progression:0}&f/&b{objective_goal:0}'
        goto: OBJECT 11
        goals:
          0:
            goal: 1
            take: true
            check: SameBase
            item:
              type: ghast_tear
              nbt:
                MMOITEMS_ITEM_TYPE: RPG_FOOD_FARM
                MMOITEMS_ITEM_ID: '小麥'

      11:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 12
        toggle: true
        
      12:
        type: SERVER_ACTIONS
        objective_detail: '&a<艾琳娜>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
        goto: OBJECT 13
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<艾琳娜> &f你好,我是餐廳負責人&a[艾琳娜]'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<艾琳娜> &f請問你是一位嗎?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      13:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<艾琳娜>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[不是的小姐,請問是不是找了&a[公會委托]&f的?我是來給&a小麥&f的]'
            goto: OBJECT 14

      14:
        type: SERVER_ACTIONS
        objective_detail: '&a<艾琳娜>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
        goto: OBJECT 15
        actions:
          - 'SEND_MESSAGE &e[1/3]&a<艾琳娜> &f甚麼小姐啦,阿姨我一把年齡了,哈哈'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<艾琳娜> &f那真是辛苦你了,冒險者,小麥交給我就可以了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<艾琳娜> &f這裡是給你們的報酬,下次有時間的話再來我們餐廳嘗嘗'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      15:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 16
        toggle: false
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b與&a<羅德@42>&f對話'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f與&a<羅德@42>&f對話'

      16:
        type: PLAYER_CITIZENS_NPC_INTERACT
        objective_detail: '&f與&a<羅德>&f對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
          - '&f步驟-4 &f與&a<羅德@42>&f對話'
        goto: OBJECT 17
        position:
          type: CITIZENS_NPC_RELATIVE_SINGLE
          npc: 437
        npc: 437

      17:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 18
        toggle: true

      18:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
          - '&f步驟-4 &f與&a<羅德@42>&f對話'
        goto: OBJECT 19
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f你把&a[小麥]&f交給誰了?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      19:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<艾琳娜>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[交給&a[艾琳娜]&f了]'
            goto: OBJECT 20

      20:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
          - '&f步驟-4 &f與&a<羅德@42>&f對話'
        goto: OBJECT 21
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f怎樣,你懂了嗎?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      21:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<艾琳娜>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[懂?甚麼懂?]'
            goto: OBJECT 22
          
      22:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
          - '&f步驟-4 &f與&a<羅德@42>&f對話'
        goto: OBJECT 23
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f呀...你真的好像甚麼都不懂喔'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f那就算了,你當沒事發生吧'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      23:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<艾琳娜>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> &f[怎麼了嗎?我不懂,是他們家的食物其實很難吃?]'
            goto: OBJECT 24
            
      24:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅德>&f正在與你對話'
        objective_detail_verbose: 
          - '&f步驟-1 &f與&a<羅德@42>&f對話'
          - '&f步驟-2 &f交付&a[小麥]&f給&a<艾琳娜@31> &b1&f/&b1'
          - '&f步驟-3 &f與&a<艾琳娜@31>&f對話'
          - '&f步驟-4 &f與&a<羅德@42>&f對話'
        goto: OBJECT 25
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<羅德> &f沒事啦,兄弟,哈哈~'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      25:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: QUEST_SUCCESS
        toggle: false

end_objects:
  success:
    a:
      type: SERVER_COMMANDS_PERFORM
      commands: 
        - heal {player}
  cancel:
    1:
      type: SERVER_COMMANDS_PERFORM
      commands: ['compass stop {player}']