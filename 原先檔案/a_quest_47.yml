# -------------------- Display settings --------------------

display_name: '&e[主線]合作任務'

start_notify:
  title: '&a任務開始'
  title_subtitle: '&7開始進行 &a{quest} &7任務'
  sound: ENTITY_PLAYER_LEVELUP

progress_notify:
  actionbar: '&a{quest} &7| {objective}'

all_status_item:
  type: END_CRYSTAL
  name: '&6{quest}'
  lore: |-
    &f--------------------
    &f任務報酬：
    &f- &e金幣&fx1000
    &f- &a總經驗值&fx135000
    &f--------------------{detailed_progression}
    {controls}

# -------------------- Post-quest settings --------------------

completion:
  notify:
    SUCCESS:
      title: '&d任務完成'
      title_subtitle: '&7你完成了任務 &a{quest} &7!'
      sound: ENTITY_PLAYER_LEVELUP
      message:
        - '&f--------------------'
        - '&f解鎖&e[主線]找回項鍊'
        - '&f可在&a[帝貝鎮]&f向&a<賽斯>&f接取'
        - '&f--------------------'
        - '&f需要滿足以下條件才能接取任務：'
        - '&a等級：Lv48'
        - '&f--------------------'
    FAIL:
      title: '&cQuest failed'
      title_subtitle: '&7You failed quest &c{quest} &7!'
      sound: BLOCK_ANVIL_DESTROY
    CANCEL:
      title: '&c任務取消'
      title_subtitle: '&7你取消了任務 &c{quest}'
      sound: BLOCK_ANVIL_DESTROY

activators: [cnpc173]

conditions_start_restriction:
  match_amount: 2
  conditions:
    1:
      type: LOGIC
      logic: '%mmocore_level% >= 47'
    2:
      type: QUEST_COMPLETED
      model: a_quest_46

display_priority: 1

branches:

  main:
    starts_at: 1
    objects:

      1:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 2
        toggle: true

      2:
        type: SERVER_ACTIONS
        objective_detail: '&a<愛比>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
        goto: OBJECT 3
        actions:
          - 'SEND_MESSAGE &e[1/4]&a<愛比> &f最近封印沙漠出現了一種新的怪物沙漠骷髏'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/4]&a<愛比> &f目前對牠們出現的原因和危險度不太清楚'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/4]&a<蘭> &f沒問題,我們兩個就能查好這些骷髏'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/4]&a<蘭> &f來,走吧'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      3:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<蘭>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [好的,那我們出發了]'
            goto: OBJECT 4

      4:
        type: SERVER_ACTIONS
        objective_detail: '&a<愛比>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
        goto: OBJECT 5
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<愛比> &f好,請小心一點不要亂來'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      5:
        type: SERVER_CAMERA_MODE_TOGGLE
        start_notify:
          message: '&e[任務提示]&f跟著&a<蘭>&f走'
          title: '&e任務提示'
          title_subtitle: '&e跟著&a<蘭>&f走'
        goto: OBJECT 6
        toggle: false

      6:
        type: SERVER_GCORE_NPC_NAVIGATE
        objective_detail: '&f跟著&a<蘭>&f走'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
        goto: OBJECT 7
        gps:
          enabled: false
        position:
          type: SINGLE
          location: world,-3400,73,733,0,0
        wait_for_player_radius: 10
        npc: 9
        
      7:
        type: SERVER_ACTIONS
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f與&a<蘭>&f對話'
        goto: OBJECT 8
        actions:
          - WAIT_TICKS 2
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e與&a<蘭>&f對話'
          message: '&e[任務提示]&f與&a<蘭>&f對話'
          
      8:
        type: PLAYER_GCORE_NPC_INTERACT
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f與&a<蘭>&f對話'
        goto: OBJECT 9
        npc: 9

      9:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 10
        toggle: true
          
      10:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f與&a<蘭>&f對話'
        goto: OBJECT 11
        actions:
          - 'SEND_MESSAGE &e[1/5]&a<蘭> &f跟你說,這東西叫電梯'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/5]&a<蘭> &f好像是新月城的科學家研究出來的'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/5]&a<蘭> &f這可是真方便,以前的話...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/5]&a<蘭> &f要從下面爬上來也要花個半小時'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[5/5]&a<蘭> &f真是有夠累的...來,走吧'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      11:
        type: SERVER_GCORE_NPC_TELEPORT
        npc: 9
        goto: OBJECT 12
        position:
          type: SINGLE
          location: world,-3368,18,729,270,0
          
      12:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 13
        toggle: false
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e下去與&a<蘭>&f對話'
          message: '&e[任務提示]&f下去與&a<蘭>&f對話'

      13:
        type: PLAYER_GCORE_NPC_INTERACT
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
        goto: OBJECT 14
        npc: 9

      14:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 15
        toggle: true
            
      15:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
        goto: OBJECT 16
        actions:
          - 'SEND_MESSAGE &e[1/4]&a<蘭> &f前面好像就是沙漠骷髏了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/4]&a<蘭> &f的確是新的不死族,之前我也沒有見過它們'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/4]&a<蘭> &f那就交給你殺死它們了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/4]&a<蘭> &f我在這裡做書面記錄'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      16:
        type: SERVER_GCORE_NPC_SET_EQUIPMENT
        goto: OBJECT 17
        npc: 9
        held_item:
          type: WRITABLE_BOOK

      17:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 18
        toggle: false
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e擊殺&a【Lv51】沙漠骷髏士兵'
          message: '&e[任務提示]&f擊殺&a【Lv51】沙漠骷髏士兵'

      18:
        type: PLAYER_MYTHICMOBS_MOBS_KILL
        objective_detail: '&f擊殺&a【Lv51】沙漠骷髏士兵&e{objective_progression:0}&f/&e{objective_goal:0}'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e{objective_progression:0}&f/&e{objective_goal:0}'
        goto: OBJECT 19
        goals:
          0:
            mobs: '【Lv51】沙漠骷髏士兵'
            goal: 20
            
      19:
        type: SERVER_ACTIONS
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
        goto: OBJECT 20
        actions:
          - WAIT_TICKS 2
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e與&a<蘭>&f對話'
          message: '&e[任務提示]&f與&a<蘭>&f對話'
            
      20:
        type: PLAYER_GCORE_NPC_INTERACT
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
        goto: OBJECT 21
        npc: 9

      21:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 22
        toggle: true
            
      22:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
        goto: OBJECT 23
        actions:
          - 'SEND_MESSAGE &e[1/3]&a<蘭> &f你的身手不錯喔'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<蘭> &f我都把它們的攻擊模式記錄下來了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<蘭> &f那我們先回去回報一下吧'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      23:
        type: SERVER_PLAYER_TELEPORT
        goto: OBJECT 24
        position:
          type: SINGLE
          location: world,-3367,68,947,180,0
          
      24:
        type: SERVER_GCORE_NPC_TELEPORT
        goto: OBJECT 25
        position:
          type: SINGLE
          location: world,-3365,68,943,0,0
        npc: 9
          
      25:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
        goto: OBJECT 26
        actions:
          - 'SEND_MESSAGE &e[1/4]&a<愛比> &f這個記錄很清晰,連攻擊模式都寫下來'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/4]&a<愛比> &f我代表所有冒險者感謝你們的幫忙'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/4]&a<愛比> &f這是你們的報酬'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &b[故事劇情](接待員把錢袋給了蘭)'
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/4]&a<蘭> &f謝了,那我們先走囉'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      26:
        type: SERVER_GCORE_NPC_SET_EQUIPMENT
        goto: OBJECT 27
        npc: 9
        held_item:
          type: AIR
          
      27:
        type: SERVER_CAMERA_MODE_TOGGLE
        start_notify:
          message: '&e[任務提示]&f跟著&a<蘭>&f走'
          title: '&e任務提示'
          title_subtitle: '&e跟著&a<蘭>&f走'
        goto: OBJECT 28
        toggle: false

      28:
        type: SERVER_GCORE_NPC_NAVIGATE
        objective_detail: '&f跟著&a<蘭>&f走'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
        goto: OBJECT 29
        gps:
          enabled: false
        position:
          type: SINGLE
          location: world,-3376,68,899,0,0
        wait_for_player_radius: 10
        npc: 9
        
      29:
        type: SERVER_ACTIONS
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        goto: OBJECT 30
        actions:
          - WAIT_TICKS 2
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e與&a<蘭>&f對話'
          message: '&e[任務提示]&f與&a<蘭>&f對話'
          
      30:
        type: PLAYER_GCORE_NPC_INTERACT
        objective_detail: '&f與&a<蘭>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        goto: OBJECT 31
        npc: 9

      31:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 32
        toggle: true
          
      32:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        goto: OBJECT 33
        actions:
          - 'SEND_MESSAGE &e[1/3]&a<蘭> &f來,這是給你的錢'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<蘭> &f謝謝你和我一起去做任務'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<蘭> &f很高興認識你'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      33:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<蘭>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [我也是]'
            goto: OBJECT 34

      34:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        goto: OBJECT 35
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<蘭> &f對了,你是不是要去找威廉大哥?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<蘭> &f聽說他已經回來了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      35:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<蘭>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [那我先走了,有機會再找你]'
            goto: OBJECT 36
            
      36:
        type: SERVER_ACTIONS
        objective_detail: '&a<蘭>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<愛比#188>&f對話'
          - '&f步驟-2 &f跟著&a<蘭>&f走'
          - '&f步驟-3 &f下去與&a<蘭>&f對話'
          - '&f步驟-4 &f擊殺&a【Lv51】沙漠骷髏士兵 &e20&f/&e20'
          - '&f步驟-5 &f與&a<蘭>&f對話'
          - '&f步驟-6 &f跟著&a<蘭>&f走'
          - '&f步驟-7 &f與&a<蘭>&f對話'
        goto: OBJECT 37
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<蘭> &f好的,路上小心喔'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      37:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: QUEST_SUCCESS
        toggle: false

end_objects:
  success:
    a:
      type: SERVER_COMMANDS_PERFORM
      commands:
        - eco give {player} 1000
        - mmocore admin exp give {player} farm 135000
        - mmocore admin exp give {player} fishing 135000
        - mmocore admin exp give {player} food 135000
        - mmocore admin exp give {player} handicraft 135000
        - mmocore admin exp give {player} main 135000
        - mmocore admin exp give {player} mining 135000
        - mmocore admin exp give {player} alchemy 135000
  cancel:
    1:
      type: SERVER_GCORE_NPC_TELEPORT
      position:
        type: SINGLE
        location: world,-3365,68,943,0,0
      npc: 9