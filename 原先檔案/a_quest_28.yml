# -------------------- Display settings --------------------

display_name: '&e[主線]神祕的外來人'

start_notify:
  title: '&a任務開始'
  title_subtitle: '&7開始進行 &a{quest} &7任務'
  sound: ENTITY_PLAYER_LEVELUP

progress_notify:
  actionbar: '&a{quest} &7| {objective}'

all_status_item:
  type: END_CRYSTAL
  name: '&6{quest}'
  lore: |-
    &f--------------------
    &f任務報酬：
    &f- &e金幣&fx1000
    &f- &a總經驗值&fx54450
    &f--------------------{detailed_progression}
    {controls}

# -------------------- Post-quest settings --------------------

completion:
  notify:
    SUCCESS:
      title: '&d任務完成'
      title_subtitle: '&7你完成了任務 &a{quest} &7!'
      sound: ENTITY_PLAYER_LEVELUP
      message:
        - '&f--------------------'
        - '&f解鎖&e[主線]龍的存在'
        - '&f可在&a[博多斯村莊]&f向&a<薩彌爾#99>&f接取'
        - '&f--------------------'
        - '&f需要滿足以下條件才能接取任務：'
        - '&a等級：Lv29'
        - '&f--------------------'
    FAIL:
      title: '&cQuest failed'
      title_subtitle: '&7You failed quest &c{quest} &7!'
      sound: BLOCK_ANVIL_DESTROY
    CANCEL:
      title: '&c任務取消'
      title_subtitle: '&7你取消了任務 &c{quest}'
      sound: BLOCK_ANVIL_DESTROY

activators: [cnpc92]

conditions_start_restriction:
  match_amount: 3
  conditions:
    1:
      type: LOGIC
      logic: '%mmocore_level% >= 28'
    2:
      type: QUEST_COMPLETED
      model: a_quest_27
    3:
      type: QUEST_COMPLETED
      model: s_04_23

display_priority: 1

branches:

  main:
    starts_at: 1
    objects:

      1:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 2
        toggle: true

      2:
        type: SERVER_ACTIONS
        objective_detail: '&a<羅柏#97>&f正在與你對話'
        objective_detail_verbose: '&f步驟-1 &f與&a<羅柏#97>&f對話'
        goto: OBJECT 3
        actions:
          - 'SEND_MESSAGE &e[1/4]&a<羅柏> &f剛剛有一班像是外來的人來到村莊'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/4]&a<羅柏> &f說想找有實力的冒險者幫忙'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/4]&a<羅柏> &f我想到的人選就是你了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/4]&a<羅柏> &f那就麻煩你去看一下發生甚麼事了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      3:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 4
        toggle: false
          
      4:
        type: PLAYER_CITIZENS_NPC_INTERACT
        objective_detail: '&f與&a<薩彌爾#99>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 5
        position:
          type: CITIZENS_NPC_RELATIVE_SINGLE
          npc: 294
        npc: 294
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b與&a<薩彌爾#99>&f對話'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f與&a<薩彌爾#99>&f對話'

      5:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 6
        toggle: true

      6:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 7
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<薩彌爾> &f請問你是公會派來的冒險者嗎?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      7:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<薩彌爾>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [是的,你好,有甚麼事嗎?]'
            goto: OBJECT 8
            
      8:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 9
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<薩彌爾> &f你好,我是薩彌爾,是來自其他地方的'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      9:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<薩彌爾>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [其他地方的?甚麼意思?]'
            goto: OBJECT 10

      10:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 11
        actions:
          - 'SEND_MESSAGE &e[1/3]&a<薩彌爾> &f這個先不要管了'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/3]&a<薩彌爾> &f我有關於黑龍的情報,但由於太危險'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/3]&a<薩彌爾> &f所以我只想找有實力的冒險者幫忙'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      11:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<薩彌爾>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [那要如何證明自己的實力?]'
            goto: OBJECT 12

      12:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 13
        actions:
          - 'SEND_MESSAGE &e[1/4]&a<薩彌爾> &f在下雨天,博多斯森林會出現限定生物'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/4]&a<薩彌爾> &f擊殺後拿獲得&9[召喚紙-叢林守護者]'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[3/4]&a<薩彌爾> &f在&6[鍊金術]&f中的&a[召喚書]&f,可以合成&6[召喚卷軸-叢林守護者]'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[4/4]&a<薩彌爾> &f你能親手終界的時候守護者再找我吧'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      13:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 14
        toggle: false

      14:
        type: PLAYER_MYTHICMOBS_MOBS_KILL
        objective_detail: '&f擊殺&a【Lv32】叢林守護者 &e{objective_progression:0}&f/&e{objective_goal:0}'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
          - '&f步驟-3 &f擊殺&a【Lv32】叢林守護者 &e{objective_progression:0}&f/&e{objective_goal:0}'
        goto: OBJECT 99
        goals:
          0:
            mobs: '【Lv32】叢林守護者'
            goal: 1
        start_notify:
          title: '&e任務提示'
          title_subtitle: '&e擊殺&a【Lv32】叢林守護者'
          message: '&e[任務提示]&f擊殺&a【Lv32】叢林守護者'
          
      99:
        type: PLAYER_CITIZENS_NPC_INTERACT
        objective_detail: '&f與&a<薩彌爾#99>&f對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
          - '&f步驟-3 &f擊殺&a【Lv32】叢林守護者 &e1&f/&e1'
          - '&f步驟-4 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 15
        position:
          type: CITIZENS_NPC_RELATIVE_SINGLE
          npc: 294
        npc: 294
        start_notify:
          title: '&b任務提示'
          title_subtitle: '&b與&a<薩彌爾#99>&f對話'
          message: '&#cff7fa&l[&#75f5ff&l任&#42f1ff&l務&#42f1ff&l系&#75f5ff&l統&#cff7fa&l] &f與&a<薩彌爾#99>&f對話'
          
      15:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: OBJECT 16
        toggle: true

      16:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
          - '&f步驟-3 &f擊殺&a【Lv32】叢林守護者 &e1&f/&e1'
          - '&f步驟-4 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 17
        actions:
          - 'SEND_MESSAGE &e[1/2]&a<薩彌爾> &f傳說中的&4[叢林守護者]&f只會被準備好的勇者通關'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          - 'SEND_MESSAGE &e[2/2]&a<薩彌爾> &f看來你就是傳說中的[勇者]&4!?'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40
          
      17:
        type: DIVERGE_CHAT
        objective_detail: '&f回應&a<薩彌爾>'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
        choices:
          0:
            text: '&d&l[故事劇情] 按我選擇 >> [&4[勇者]&d&l甚麼意思?]'
            goto: OBJECT 18
            
      18:
        type: SERVER_ACTIONS
        objective_detail: '&a<薩彌爾>&f正在與你對話'
        objective_detail_verbose:
          - '&f步驟-1 &f與&a<羅柏#97>&f對話'
          - '&f步驟-2 &f與&a<薩彌爾#99>&f對話'
          - '&f步驟-3 &f擊殺&a【Lv32】叢林守護者 &e1&f/&e1'
          - '&f步驟-4 &f與&a<薩彌爾#99>&f對話'
        goto: OBJECT 19
        actions:
          - 'SEND_MESSAGE &e[1/1]&a<薩彌爾> &f你準備好的話,就再來找我,我再告訴你吧...'
          - SEND_SOUND ENTITY_VILLAGER_AMBIENT
          - WAIT_TICKS 40

      19:
        type: SERVER_CAMERA_MODE_TOGGLE
        goto: QUEST_SUCCESS
        toggle: false
          
end_objects:
  success:
    a:
      type: SERVER_COMMANDS_PERFORM
      commands:
        - eco give {player} 1000
        - mmocore admin exp give {player} farm 54450
        - mmocore admin exp give {player} fishing 54450
        - mmocore admin exp give {player} food 54450
        - mmocore admin exp give {player} handicraft 54450
        - mmocore admin exp give {player} main 54450
        - mmocore admin exp give {player} mining 54450
        - mmocore admin exp give {player} alchemy 54450
  cancel:
    1:
      type: SERVER_COMMANDS_PERFORM
      commands: ['compass stop {player}']